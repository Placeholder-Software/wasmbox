"use strict";(self.webpackChunkwasmbox_docs=self.webpackChunkwasmbox_docs||[]).push([[7617],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>f});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var s=a.createContext({}),c=function(e){var t=a.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),m=c(r),p=n,f=m["".concat(s,".").concat(p)]||m[p]||d[p]||o;return r?a.createElement(f,i(i({ref:t},u),{},{components:r})):a.createElement(f,i({ref:t},u))}));function f(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[m]="string"==typeof e?e:n,i[1]=l;for(var c=2;c<o;c++)i[c]=r[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}p.displayName="MDXCreateElement"},5162:(e,t,r)=>{r.d(t,{Z:()=>i});var a=r(7294),n=r(6010);const o="tabItem_Ymn6";function i(e){let{children:t,hidden:r,className:i}=e;return a.createElement("div",{role:"tabpanel",className:(0,n.Z)(o,i),hidden:r},t)}},4866:(e,t,r)=>{r.d(t,{Z:()=>S});var a=r(7462),n=r(7294),o=r(6010),i=r(2466),l=r(6550),s=r(1980),c=r(7392),u=r(12);function m(e){return function(e){return n.Children.map(e,(e=>{if((0,n.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))}(e).map((e=>{let{props:{value:t,label:r,attributes:a,default:n}}=e;return{value:t,label:r,attributes:a,default:n}}))}function d(e){const{values:t,children:r}=e;return(0,n.useMemo)((()=>{const e=t??m(r);return function(e){const t=(0,c.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,r])}function p(e){let{value:t,tabValues:r}=e;return r.some((e=>e.value===t))}function f(e){let{queryString:t=!1,groupId:r}=e;const a=(0,l.k6)(),o=function(e){let{queryString:t=!1,groupId:r}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:t,groupId:r});return[(0,s._X)(o),(0,n.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(a.location.search);t.set(o,e),a.replace({...a.location,search:t.toString()})}),[o,a])]}function b(e){const{defaultValue:t,queryString:r=!1,groupId:a}=e,o=d(e),[i,l]=(0,n.useState)((()=>function(e){let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=r.find((e=>e.default))??r[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:o}))),[s,c]=f({queryString:r,groupId:a}),[m,b]=function(e){let{groupId:t}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,o]=(0,u.Nk)(r);return[a,(0,n.useCallback)((e=>{r&&o.set(e)}),[r,o])]}({groupId:a}),h=(()=>{const e=s??m;return p({value:e,tabValues:o})?e:null})();(0,n.useLayoutEffect)((()=>{h&&l(h)}),[h]);return{selectedValue:i,selectValue:(0,n.useCallback)((e=>{if(!p({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),c(e),b(e)}),[c,b,o]),tabValues:o}}var h=r(2389);const v="tabList__CuJ",y="tabItem_LNqP";function k(e){let{className:t,block:r,selectedValue:l,selectValue:s,tabValues:c}=e;const u=[],{blockElementScrollPositionUntilNextRender:m}=(0,i.o5)(),d=e=>{const t=e.currentTarget,r=u.indexOf(t),a=c[r].value;a!==l&&(m(t),s(a))},p=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const r=u.indexOf(e.currentTarget)+1;t=u[r]??u[0];break}case"ArrowLeft":{const r=u.indexOf(e.currentTarget)-1;t=u[r]??u[u.length-1];break}}t?.focus()};return n.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":r},t)},c.map((e=>{let{value:t,label:r,attributes:i}=e;return n.createElement("li",(0,a.Z)({role:"tab",tabIndex:l===t?0:-1,"aria-selected":l===t,key:t,ref:e=>u.push(e),onKeyDown:p,onClick:d},i,{className:(0,o.Z)("tabs__item",y,i?.className,{"tabs__item--active":l===t})}),r??t)})))}function w(e){let{lazy:t,children:r,selectedValue:a}=e;if(r=Array.isArray(r)?r:[r],t){const e=r.find((e=>e.props.value===a));return e?(0,n.cloneElement)(e,{className:"margin-top--md"}):null}return n.createElement("div",{className:"margin-top--md"},r.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function g(e){const t=b(e);return n.createElement("div",{className:(0,o.Z)("tabs-container",v)},n.createElement(k,(0,a.Z)({},e,t)),n.createElement(w,(0,a.Z)({},e,t)))}function S(e){const t=(0,h.Z)();return n.createElement(g,(0,a.Z)({key:String(t)},e))}},8833:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>p,frontMatter:()=>l,metadata:()=>c,toc:()=>m});var a=r(7462),n=(r(7294),r(3905)),o=r(4866),i=r(5162);const l={title:"WASI"},s=void 0,c={unversionedId:"basics/wasi",id:"basics/wasi",title:"WASI",description:"WASI stands for WebAssembly System Interface. It's an API that provides access to several operating-system-like features, including filesystems, clocks, and random numbers. Wasmbox provides implementations of most WASI functions (see Assets\\Plugins\\PlaceholderSoftware\\Wasmbox\\Core\\WASI\\).",source:"@site/docs/basics/wasi.md",sourceDirName:"basics",slug:"/basics/wasi",permalink:"/wasmbox/basics/wasi",draft:!1,editUrl:"https://github.com/Placeholder-Software/Wasmbox/tree/master/docs/basics/wasi.md",tags:[],version:"current",frontMatter:{title:"WASI"},sidebar:"tutorialSidebar",previous:{title:"WASM In Jobs",permalink:"/wasmbox/basics/jobs"},next:{title:"Advanced",permalink:"/wasmbox/category/advanced"}},u={},m=[],d={toc:m};function p(e){let{components:t,...l}=e;return(0,n.kt)("wrapper",(0,a.Z)({},d,l,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"WASI stands for ",(0,n.kt)("strong",{parentName:"p"},"WebAssembly System Interface"),". It's an API that provides access to several operating-system-like features, including filesystems, clocks, and random numbers. Wasmbox provides implementations of most WASI functions (see ",(0,n.kt)("inlineCode",{parentName:"p"},"Assets\\Plugins\\PlaceholderSoftware\\Wasmbox\\Core\\WASI\\"),")."),(0,n.kt)("p",null,"WASI is a way to provide ",(0,n.kt)("em",{parentName:"p"},"controlled")," access to certain system resources. For example the virtual file system implemented by Wasmbox can provide in-memory files and folders which are never saved as well as map real files/folders into the virtual files/folders, this allows you to carefully control exactly what can be accessed through WASM code."),(0,n.kt)("admonition",{type:"caution"},(0,n.kt)("p",{parentName:"admonition"},"WASM execution is normally completely ",(0,n.kt)("a",{parentName:"p",href:"/wasmbox/advanced/determinism"},"deterministic")," - running the same code with the same arguments will produce the same result every time."),(0,n.kt)("p",{parentName:"admonition"},"Adding WASI features can make execution non-deterministic since it provides access to external resources which are not deterministic (e.g. a clock, which returns a different time every time you read it).")),(0,n.kt)("p",null,"WASM Assets which import a WASI function will show a ",(0,n.kt)("inlineCode",{parentName:"p"},"WASI")," indicator next to the functions. Hovering over the indicator will show which WASI feature is required to supply this import, clicking the indicator will bring you to this this documentation page. All WASI features are interfaces which you may implement yourself, or you can use one of the built in implementations."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"WASI Import",src:r(7408).Z,width:"724",height:"133"})),(0,n.kt)(o.Z,{queryString:"wasi-feature",mdxType:"Tabs"},(0,n.kt)(i.Z,{value:"ivirtualrandomsource",label:"Random Numbers",mdxType:"TabItem"},(0,n.kt)("p",null,"Random number generation is provided by an implementation of ",(0,n.kt)("a",{parentName:"p",href:"/wasmbox/reference/code/WASI/random"},(0,n.kt)("inlineCode",{parentName:"a"},"IVirtualRandomSource")),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-clike"},"var rng = new CryptoRandomSource();\nlinker.Add(rng);\n"))),(0,n.kt)(i.Z,{value:"ivirtualprocess",label:"Process",mdxType:"TabItem"},(0,n.kt)("p",null,'Functions which would normally be associated with an OS "Process" are provided by an implementation of ',(0,n.kt)("a",{parentName:"p",href:"/wasmbox/reference/code/WASI/process"},(0,n.kt)("inlineCode",{parentName:"a"},"IVirtualProcess")),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-clike"},'var proc = new VirtualProcess(OnExit);\nlinker.Add(proc);\n\nvoid OnExit(uint code)\n{\n    Debug.Log("Process exited with code: " + code);\n}\n'))),(0,n.kt)(i.Z,{value:"ivirtualfilesystem",label:"File System",mdxType:"TabItem"},(0,n.kt)("p",null,"Functions which provide access to the filesystem are provided by an implementation of ",(0,n.kt)("a",{parentName:"p",href:"/wasmbox/reference/code/WASI/filesystem"},(0,n.kt)("inlineCode",{parentName:"a"},"IVirtualFileSystem")),'. The default implementation provides an entire "virtual filesystem" which can have a mix of real files/folders with fully virtual files/folders which are stored in memory.'),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-clike"},'// Use a "VirtualFileSystemBuilder" to define a fake file system entirely in memory\nvar builder = new VirtualFileSystemBuilder()\n    .WithVirtualRoot(root => {\n        root.CreateVirtualDirectory("A")\n            .CreateVirtualDirectory("B", dir => {\n                dir.CreateInMemoryFile("File.txt");\n            })\n    });\n\nlinker.Add(builder.Build());\n'))),(0,n.kt)(i.Z,{value:"ivirtualenvironment",label:"Environment",mdxType:"TabItem"},(0,n.kt)("p",null,'Functions which would normally be associated with an OS "Environment" are provided by an implementation of ',(0,n.kt)("a",{parentName:"p",href:"/wasmbox/reference/code/WASI/environment"},(0,n.kt)("inlineCode",{parentName:"a"},"IVirtualEnvironment")),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-clike"},'var env = new VirtualEnvironment()\n    .PassthroughEnvironmentVariables()                      // Add all of the real environment variables\n    .SetEnvironmentVariable("foo", "bar")                   // Create a variable named "foo" with value "bar"\n    .SetArgs("--foo", "--bar", "bash", "-b", "-a", "-z"));  // Set the WASM process arguments\n\nlinker.Add(env);\n'))),(0,n.kt)(i.Z,{value:"ivirtualclock",label:"Clock",mdxType:"TabItem"},(0,n.kt)("p",null,"Functions which get the current system time are provided by an implementation of ",(0,n.kt)("a",{parentName:"p",href:"/wasmbox/reference/code/WASI/clock"},(0,n.kt)("inlineCode",{parentName:"a"},"IVirtualClock")),". A ",(0,n.kt)("inlineCode",{parentName:"p"},"RealtimeClock")," provides access to the real system time (with an optional offset). A ",(0,n.kt)("inlineCode",{parentName:"p"},"ManualClock")," provides access to a specific time which only advances when ",(0,n.kt)("inlineCode",{parentName:"p"},"clock.Tick()")," is called."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-clike"},"var clock = new RealtimeClock();\nlinker.Add(clock);\n"))),(0,n.kt)(i.Z,{value:"unknown",label:"Unknown Feature",mdxType:"TabItem"},(0,n.kt)("p",null,"Not all WASI functions are supported by the built in Wasmbox WASI features. Please contacts us on ",(0,n.kt)("a",{parentName:"p",href:"https://discord.gg/3RtDa2M9Bx"},"Discord")," or on the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/Placeholder-Software/wasmbox/issues"},"Issue Tracker")," about the specific feature you need."))),(0,n.kt)("hr",null))}p.isMDXComponent=!0},7408:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/InspectorWasi-36bbf1e78e5643310ae78ccd0fd95a9c.png"}}]);